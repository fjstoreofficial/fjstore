<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FJ.Store ‚Äì Produk</title>
<style>
/* ===== RESET & BACKGROUND ===== */
body{
  margin:0; padding:0; font-family:Poppins, sans-serif;
  background:url("latarbelakang.jpg") center/cover no-repeat fixed;
  position: relative;
}
body::before{
  content:""; position: fixed; inset:0; backdrop-filter: blur(9px);
  background: rgba(0,0,0,0.45); z-index:-1;
}

/* ===== HEADER ===== */
header{
  position: relative; padding:20px; text-align:center;
  font-size:24px; font-weight:bold; color:#fff;
  background: rgba(0,0,0,0.65); border-bottom:1px solid rgba(255,255,255,0.2);
}
#wishlistIcon, #searchIcon{
  position:absolute; top:50%; transform: translateY(-50%);
  font-size:22px; cursor:pointer; color:white; opacity:0.9; z-index:10; transition:0.25s;
}
#wishlistIcon{ right:60px; }
#wishlistIcon:hover{ transform:translateY(-50%) scale(1.15); text-shadow:0 0 15px #ff4d6d; }
#searchIcon{ right:20px; font-size:20px; }
#searchIcon:hover{ transform:translateY(-50%) scale(1.15); opacity:1; }

/* ===== PRODUK GRID ===== */
.products-container{
  max-width:1200px; margin:20px auto; padding:20px;
  display:grid; gap:20px; grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
}
.product-card{
  position: relative; background: rgba(255,255,255,0.15); backdrop-filter:blur(7px);
  border-radius:14px; padding:15px; text-align:center; color:#fff; text-decoration:none;
  transition:0.3s; box-shadow:0 4px 20px rgba(0,0,0,0.25); border:1px solid rgba(255,255,255,0.25);
}
.product-card:hover{
  transform: scale(1.05); background: rgba(255,255,255,0.26); box-shadow:0 6px 30px rgba(0,0,0,0.35);
}
.product-card img{ width:100%; height:220px; object-fit:cover; border-radius:10px; margin-bottom:12px; }
.product-name{ font-size:18px; font-weight:bold; text-shadow:1px 1px 3px #000; }
.product-price{ font-size:16px; font-weight:bold; color:#ffeb3b; margin-top:5px; text-shadow:1px 1px 3px #000; }

/* ===== WISHLIST HEART ===== */
.wishlist-heart{
  position:absolute; top:12px; right:12px; font-size:22px; cursor:pointer;
  transition: transform 0.25s, color 0.25s; text-shadow:1px 1px 4px black; opacity:0.85; z-index:99;
}
.wishlist-heart:hover{ transform: scale(1.15); opacity:1; }
.wishlist-heart.active{
  color:#ff4d6d; transform: scale(1.25); animation: bounce 0.3s;
}
@keyframes bounce{0%{transform:scale(1);}50%{transform:scale(1.4);}100%{transform:scale(1.25);}}

/* ===== SEARCH OVERLAY ===== */
#searchOverlay{
  position: fixed; inset:0; display:none; justify-content:flex-start; align-items:center; flex-direction:column;
  background:rgba(0,0,0,0.88); backdrop-filter: blur(10px); padding-top:120px; z-index:9999;
}
#searchBox{
  width:80%; max-width:600px; padding:15px 20px; border-radius:12px; border:none; font-size:20px; outline:none;
}
#closeSearch{
  position:absolute; top:30px; right:35px; font-size:26px; color:white; cursor:pointer; opacity:0.8; transition:0.3s;
}
#closeSearch:hover{ opacity:1; transform: scale(1.15); }
#searchResults{ width:80%; max-width:650px; margin:25px auto; }
.search-item{
  display:flex; align-items:center; gap:15px; background: rgba(255,255,255,0.15); padding:12px;
  border-radius:12px; margin-bottom:10px; cursor:pointer; transition:0.25s; color:white; border:1px solid rgba(255,255,255,0.25);
}
.search-item:hover{ background: rgba(255,255,255,0.28); transform: scale(1.02);}
.search-thumb{ width:65px; height:65px; border-radius:10px; object-fit:cover; }
.search-text{ display:flex; flex-direction:column; gap:4px; }
.search-title{ font-size:17px; font-weight:600; }
.search-price{ font-size:14px; color:#ffeb3b; }

/* ===== PARTICLE ===== */
.particle{ position:absolute; width:6px; height:6px; background:#ff4d6d; border-radius:50%; pointer-events:none; animation:particleMove 0.8s forwards; z-index:100; }
@keyframes particleMove{ 0%{transform:translate(0,0) scale(1); opacity:1;} 100%{transform:translate(var(--x),var(--y)) scale(0); opacity:0;} }

</style>
</head>
<body>

<header>
  Produk FJ.Store
  <span id="wishlistIcon">‚ù§Ô∏è <span id="wishlistCount">(0)</span></span>
  <span id="searchIcon">üîç</span>
</header>

<div class="products-container" id="products"></div>

<div id="searchOverlay">
  <div id="closeSearch">‚úñ</div>
  <input id="searchBox" type="text" placeholder="Cari produk..." autocomplete="off"/>
  <div id="searchResults"></div>
</div>

<script>
/* ===== LOAD PRODUK ===== */
let allProducts=[];
async function loadProducts(){
  try{
    const res = await fetch("products.json");
    const data = await res.json();
    allProducts = data;
    const container = document.getElementById("products");
    container.innerHTML = "";
    data.forEach(p=>{
      const card = document.createElement("a");
      card.className="product-card";
      card.href = `detail.html?id=${p.id}`;
      card.innerHTML = `
        <img src="${p.image}" alt="${p.name}">
        <div class="product-name">${p.name}</div>
        <div class="product-price">Rp ${Number(p.price).toLocaleString("id-ID")}</div>
      `;
      container.appendChild(card);
    });
  }catch(e){ console.error("Gagal load produk:", e); }
}
loadProducts();

/* ===== WISHLIST SYSTEM ===== */
let wishlist = JSON.parse(localStorage.getItem("wishlist")||"[]");
function saveWishlist(){ localStorage.setItem("wishlist", JSON.stringify(wishlist)); }
function updateWishlistCounter(){ document.getElementById("wishlistCount").innerText = `(${wishlist.length})`; }
updateWishlistCounter();

const observer = new MutationObserver(()=>{
  document.querySelectorAll(".product-card").forEach(card=>{
    if(card.querySelector(".wishlist-heart")) return;
    const url = new URL(card.href);
    const id = url.searchParams.get("id");
    const heart = document.createElement("div");
    heart.className="wishlist-heart"; heart.innerText="‚ù§";
    if(wishlist.includes(id)) heart.classList.add("active");

    heart.onclick = e=>{
      e.preventDefault(); e.stopPropagation();
      const rect = heart.getBoundingClientRect();
      const cx = rect.left + rect.width/2;
      const cy = rect.top + rect.height/2;

      if(wishlist.includes(id)){
        wishlist = wishlist.filter(x=>x!==id);
        heart.classList.remove("active");
      }else{
        wishlist.push(id);
        heart.classList.add("active");
        for(let i=0;i<8;i++){
          const p = document.createElement("div");
          p.className="particle";
          const angle=Math.random()*2*Math.PI;
          const radius=30+Math.random()*20;
          p.style.left=`${heart.offsetLeft + heart.offsetWidth/2}px`;
          p.style.top=`${heart.offsetTop + heart.offsetHeight/2}px`;
          p.style.setProperty("--x",`${Math.cos(angle)*radius}px`);
          p.style.setProperty("--y",`${Math.sin(angle)*radius}px`);
          card.appendChild(p);
          setTimeout(()=>p.remove(),800);
        }
      }
      saveWishlist();
      updateWishlistCounter();
    };

    card.appendChild(heart);
  });
});
observer.observe(document.body,{subtree:true,childList:true});
document.getElementById("wishlistIcon").onclick = ()=>{ window.location.href="wishlist.html"; };

/* ===== SEARCH SYSTEM ===== */
const overlay=document.getElementById("searchOverlay");
const searchIcon=document.getElementById("searchIcon");
const closeSearch=document.getElementById("closeSearch");
const searchBox=document.getElementById("searchBox");
const searchResults=document.getElementById("searchResults");

searchIcon.onclick = ()=>{ overlay.style.display="flex"; searchBox.focus(); };
function closeOverlay(){ overlay.style.display="none"; searchBox.value=""; searchResults.innerHTML=""; }
closeSearch.onclick=closeOverlay;
overlay.addEventListener("click", e=>{ if(e.target===overlay) closeOverlay(); });
document.addEventListener("keydown", e=>{ if(e.key==="Escape") closeOverlay(); });
searchBox.addEventListener("input", ()=>{
  const key = searchBox.value.toLowerCase();
  searchResults.innerHTML="";
  if(key.length===0) return;
  const filtered = allProducts.filter(p=>p.name.toLowerCase().includes(key));
  if(filtered.length===0){ searchResults.innerHTML="<div style='color:white'>Tidak ada produk ditemukan</div>"; return; }
  filtered.forEach(p=>{
    const div=document.createElement("div");
    div.className="search-item";
    div.innerHTML=`<img src="${p.image}" class="search-thumb">
      <div class="search-text"><div class="search-title">${p.name}</div>
      <div class="search-price">Rp ${Number(p.price).toLocaleString("id-ID")}</div></div>`;
    div.onclick=()=>{ window.location.href=`detail.html?id=${p.id}`; };
    searchResults.appendChild(div);
  });
});
</script>
</body>
</html>
