<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FJ.Store ‚Äì Produk</title>
  <link rel="stylesheet" href="style.css" />

  <style>
    /* ====== BACKGROUND PREMIUM ====== */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: url("latarbelakang.jpg") center/cover no-repeat fixed;
      position: relative;
    }

    body::before {
      content: "";
      position: fixed;
      inset: 0;
      backdrop-filter: blur(9px);
      background: rgba(0, 0, 0, 0.45);
      z-index: -1;
    }

    /* ===== HEADER ===== */
    header {
      background: rgba(0, 0, 0, 0.65);
      padding: 20px;
      text-align: center;
      color: white;
      font-size: 24px;
      font-weight: bold;
      border-bottom: 1px solid rgba(255,255,255,0.2);
      animation: fadeIn 1s ease-out;
      position: relative;
    }

    /* ===== SEARCH ICON ===== */
    #searchIcon {
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 20px;
      cursor: pointer;
      color: white;
      opacity: 0.8;
      transition: 0.3s;
    }
    #searchIcon:hover {
      opacity: 1;
      transform: translateY(-50%) scale(1.15);
    }

    /* ===== WISHLIST ICON ===== */
    #wishlistIcon {
      position:absolute;
      right:60px;
      top:50%;
      transform:translateY(-50%);
      cursor:pointer;
      font-size:22px;
      color:white;
      opacity:.9;
      transition:.25s;
    }
    #wishlistIcon:hover {
      transform: translateY(-50%) scale(1.15);
      opacity:1;
    }

    /* ===== GRID PRODUK ===== */
    .products-container {
      padding: 20px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 20px;
      max-width: 1200px;
      margin: auto;
      animation: fadeUp 1s ease-out;
    }

    .product-card {
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(7px);
      border-radius: 14px;
      padding: 15px;
      text-align: center;
      transition: 0.3s;
      text-decoration: none;
      color: white;
      box-shadow: 0 4px 20px rgba(0,0,0,0.25);
      border: 1px solid rgba(255,255,255,0.25);
      animation: popIn 0.6s ease-out;
      position: relative;
    }

    .product-card:hover {
      transform: scale(1.05);
      background: rgba(255,255,255,0.26);
      box-shadow: 0 6px 30px rgba(0,0,0,0.35);
    }

    .product-card img {
      width: 100%;
      height: 220px;
      object-fit: cover;
      border-radius: 10px;
      margin-bottom: 12px;
    }

    .product-name {
      font-size: 18px;
      font-weight: bold;
      color: #fff;
      text-shadow: 1px 1px 3px #000;
    }

    .product-price {
      color: #ffeb3b;
      font-size: 16px;
      font-weight: bold;
      margin-top: 5px;
      text-shadow: 1px 1px 3px #000;
    }

    /* ===== HEART WISHLIST ===== */
    .wishlist-heart {
      position: absolute;
      top: 12px;
      right: 12px;
      font-size: 22px;
      cursor: pointer;
      transition: .25s;
      text-shadow: 1px 1px 4px black;
      opacity: .85;
    }
    .wishlist-heart:hover {
      transform: scale(1.15);
      opacity: 1;
    }
    .wishlist-heart.active {
      color: #ff4d6d;
      transform: scale(1.25);
    }

    /* ===== OVERLAY SEARCH ===== */
    #searchOverlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.88);
      backdrop-filter: blur(10px);
      display: none;
      justify-content: flex-start;
      align-items: center;
      padding-top: 120px;
      z-index: 99999;
      flex-direction: column;
      animation: fadeOverlay .25s ease;
    }

    @keyframes fadeOverlay {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    #searchBox {
      width: 80%;
      max-width: 600px;
      margin: auto;
      padding: 15px 20px;
      border-radius: 12px;
      border: none;
      font-size: 20px;
      outline: none;
    }

    #closeSearch {
      position: absolute;
      top: 30px;
      right: 35px;
      font-size: 26px;
      color: white;
      cursor: pointer;
      opacity: 0.8;
      transition: 0.3s;
    }
    #closeSearch:hover {
      opacity: 1;
      transform: scale(1.15);
    }

    /* ===== HASIL SEARCH ===== */
    #searchResults {
      width: 80%;
      max-width: 650px;
      margin: 25px auto;
    }

    .search-item {
      display: flex;
      align-items: center;
      gap: 15px;
      background: rgba(255,255,255,0.15);
      padding: 12px;
      border-radius: 12px;
      margin-bottom: 10px;
      cursor: pointer;
      transition: 0.25s;
      color: white;
      border: 1px solid rgba(255,255,255,0.25);
    }

    .search-item:hover {
      background: rgba(255,255,255,0.28);
      transform: scale(1.02);
    }

    .search-thumb {
      width: 65px;
      height: 65px;
      border-radius: 10px;
      object-fit: cover;
    }

    .search-text {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .search-title {
      font-size: 17px;
      font-weight: 600;
    }

    .search-price {
      color: #ffeb3b;
      font-size: 14px;
    }

    /* ANIMASI */
    @keyframes fadeIn { from { opacity:0; } to { opacity:1; } }
    @keyframes fadeUp { from { opacity:0; transform:translateY(10px);} to { opacity:1; transform:none;} }
    @keyframes popIn { 0%{opacity:0;transform:scale(0.85);} 100%{opacity:1;transform:scale(1);} }
  </style>
</head>

<body>

  <header>
    Produk FJ.Store

    <!-- WISHLIST ICON -->
    <span id="wishlistIcon">
      ‚ù§Ô∏è <span id="wishlistCount">(0)</span>
    </span>

    <span id="searchIcon">üîç</span>
  </header>

  <div class="products-container" id="products"></div>

  <!-- ===== SEARCH OVERLAY ===== -->
  <div id="searchOverlay">
    <div id="closeSearch">‚úñ</div>
    <input id="searchBox" type="text" placeholder="Cari produk..." autocomplete="off" />
    <div id="searchResults"></div>
  </div>

  <!-- ========== LOAD PRODUK ========== -->
  <script>
    async function loadProducts() {
      try {
        const res = await fetch("products.json");
        const data = await res.json();

        const container = document.getElementById("products");
        container.innerHTML = "";

        data.forEach(p => {
          container.innerHTML += `
            <a href="detail.html?id=${p.id}" class="product-card">
              <img src="${p.image}" alt="${p.name}">
              <div class="product-name">${p.name}</div>
              <div class="product-price">Rp ${Number(p.price).toLocaleString("id-ID")}</div>
            </a>
          `;
        });

      } catch (e) {
        console.error("Gagal load produk:", e);
      }
    }

    loadProducts();
  </script>

  <!-- ========== SEARCH ========== -->
  <script>
    const overlay = document.getElementById("searchOverlay");
    const searchIcon = document.getElementById("searchIcon");
    const closeSearch = document.getElementById("closeSearch");
    const searchBox = document.getElementById("searchBox");
    const searchResults = document.getElementById("searchResults");

    let allProducts = [];

    fetch("products.json")
      .then(r => r.json())
      .then(d => allProducts = d);

    searchIcon.onclick = () => {
      overlay.style.display = "flex";
      searchBox.focus();
    };

    function closeOverlay() {
      overlay.style.display = "none";
      searchBox.value = "";
      searchResults.innerHTML = "";
    }

    closeSearch.onclick = closeOverlay;

    overlay.addEventListener("click", e => {
      if (e.target === overlay) closeOverlay();
    });

    document.addEventListener("keydown", e => {
      if (e.key === "Escape") closeOverlay();
    });

    searchBox.addEventListener("input", () => {
      const key = searchBox.value.toLowerCase();
      searchResults.innerHTML = "";

      if (key.length === 0) return;

      const filtered = allProducts.filter(p =>
        p.name.toLowerCase().includes(key)
      );

      if (filtered.length === 0) {
        searchResults.innerHTML = "<div style='color:white'>Tidak ada produk ditemukan</div>";
        return;
      }

      filtered.forEach(p => {
        const div = document.createElement("div");
        div.className = "search-item";
        div.innerHTML = `
          <img src="${p.image}" class="search-thumb">
          <div class="search-text">
            <div class="search-title">${p.name}</div>
            <div class="search-price">Rp ${Number(p.price).toLocaleString("id-ID")}</div>
          </div>
        `;

        div.onclick = () => {
          window.location.href = `detail.html?id=${p.id}`;
        };

        searchResults.appendChild(div);
      });
    });
  </script>

  <!-- ========== WISHLIST SYSTEM ========== -->
  <script>
    let wishlist = JSON.parse(localStorage.getItem("wishlist") || "[]");

    function saveWishlist() {
      localStorage.setItem("wishlist", JSON.stringify(wishlist));
    }

    function updateWishlistCounter() {
      document.getElementById("wishlistCount").innerText = `(${wishlist.length})`;
    }

    updateWishlistCounter();

    /* MENAMBAHKAN HATI KE CARD */
    const observer = new MutationObserver(() => {
      document.querySelectorAll(".product-card").forEach(card => {
        if (card.querySelector(".wishlist-heart")) return;

        const url = new URL(card.href);
        const id = url.searchParams.get("id");

        const heart = document.createElement("div");
        heart.className = "wishlist-heart";
        heart.innerHTML = "‚ù§";

        if (wishlist.includes(id)) heart.classList.add("active");

        heart.onclick = (e) => {
          e.preventDefault();

          if (wishlist.includes(id)) {
            wishlist = wishlist.filter(x => x !== id);
            heart.classList.remove("active");
          } else {
            wishlist.push(id);
            heart.classList.add("active");
          }

          saveWishlist();
          updateWishlistCounter();
        };

        card.appendChild(heart);
      });
    });

    observer.observe(document.body, { subtree: true, childList: true });

    /* BUKA HALAMAN WISHLIST */
    document.getElementById("wishlistIcon").onclick = () => {
      window.location.href = "wishlist.html";
    };
  </script>

</body>
</html>
